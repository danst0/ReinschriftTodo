{% set current_section = namespace(value=None) %}
{% for todo in todos %}
    {% if todo.section != current_section.value %}
        <div class="section-header">{{ todo.section }}</div>
        {% set current_section.value = todo.section %}
    {% endif %}
    
    <div class="todo-item {% if todo.done %}done{% endif %}" onclick="openEditModal({{ todo.line_index }})" style="cursor: pointer;">
        <a href="javascript:void(0)" class="checkbox {% if not todo.done %}unchecked{% endif %}" onclick="toggleTodo(event, {{ todo.line_index }})">
            {% if todo.done %}‚òë{% else %}‚òê{% endif %}
        </a>
        <div class="content">
            <div class="title">{{ todo.title }}</div>
            <div class="meta">
                {% if todo.project %}<span class="tag project">+{{ todo.project }}</span>{% endif %}
                {% if todo.context %}<span class="tag context">@{{ todo.context }}</span>{% endif %}
                {% if todo.due %}<span class="due">{{ t.due }} {{ todo.due }}</span>{% endif %}
            </div>
        </div>
        <div class="actions" style="margin-left: auto; display: flex; gap: 0.5rem;">
            <a href="javascript:void(0)" class="btn-action" onclick="postponeTodo(event, {{ todo.line_index }}, 'today')" title="{{ t.today }}">üìÖ</a>
            <a href="javascript:void(0)" class="btn-action" onclick="postponeTodo(event, {{ todo.line_index }}, 'tomorrow')" title="{{ t.tomorrow }}">‚û°Ô∏è</a>
        </div>
    </div>
{% endfor %}
